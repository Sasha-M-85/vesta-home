<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Клиенты</title>
</head>
<body>
  <h2>Список клиентов</h2>
  <table border="1" style="width:100%; border-collapse: collapse;">
    <thead>
      <tr>
        <th>ID</th>
        <th>Имя</th>
        <th>Телефон</th>
        <th>Создан</th>
      </tr>
    </thead>
    <tbody id="clients-table-body">
      <!-- Данные появятся здесь -->
    </tbody>
  </table>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    const supabaseUrl = 'https://rincxoalnhfsnwgwxrfb.supabase.co'
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJpbmN4b2Fsbmhmc253Z3d4cmZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM2MjE2MzMsImV4cCI6MjA2OTE5NzYzM30.95JhUW9uRbcHSkFCXyh40acSAAnJIj3nbUICQGqW32Y'

    const supabase = createClient(supabaseUrl, supabaseKey)

    async function loadClients() {
      const { data, error } = await supabase
        .from('clients')
        .select('*')
        .order('id', { ascending: false })

      if (error) {
        console.error('Ошибка при загрузке клиентов:', error.message)
        return
      }

      const tableBody = document.getElementById('clients-table-body')
      tableBody.innerHTML = ''

      data.forEach(client => {
        const row = document.createElement('tr')
        row.innerHTML = `
          <td>${client.id}</td>
          <td>${client.name}</td>
          <td>${client.phone}</td>
          <td>${new Date(client.created_at).toLocaleString()}</td>
        `
        tableBody.appendChild(row)
      })
    }

    loadClients()
  </script>
</body>
</html>
